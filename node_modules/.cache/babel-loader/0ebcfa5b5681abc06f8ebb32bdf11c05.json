{"ast":null,"code":"import _classCallCheck from\"/Users/danielmiranda/PycharmProjects/timely/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/danielmiranda/PycharmProjects/timely/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/danielmiranda/PycharmProjects/timely/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/danielmiranda/PycharmProjects/timely/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/danielmiranda/PycharmProjects/timely/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component}from'react';import'../css/EmployeeHomePage.css';import NavBar from\"./NavBar\";import Accordion from'react-bootstrap/Accordion';import Card from'react-bootstrap/Card';import Button from'react-bootstrap/Button';import{LinkContainer}from'react-router-bootstrap';import Moment from'react-moment';import Alert from'react-bootstrap/Alert';import axios from\"axios\";import Collapse from'react-bootstrap/Collapse';var BASE_API_URL=process.env.REACT_APP_BASE_URL;var EmployeeHomePage=/*#__PURE__*/function(_Component){_inherits(EmployeeHomePage,_Component);function EmployeeHomePage(props){var _this;_classCallCheck(this,EmployeeHomePage);_this=_possibleConstructorReturn(this,_getPrototypeOf(EmployeeHomePage).call(this,props));_this.getUserInfo=function(){axios.get(\"\".concat(BASE_API_URL,\"timely_backend/current_user/\"),{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}}).then(function(response){var currentUserInfo=response.data;_this.setState({first_name:currentUserInfo.first_name,profile_id:currentUserInfo.id,is_loading:false});}).finally(function(){_this.getProfileInfo();});};_this.getProfileInfo=function(){axios.get(\"\".concat(BASE_API_URL,\"api/employees/\").concat(_this.state.profile_id,\"/\"),{params:{}})//setting profile information in state\n.then(function(response){var profile=response.data;_this.setState({profile:profile});//preferredName = profile['preferred_name']\n})//if theres an error console log it\n.catch(function(error){console.log(error);})//After everything, set is-loading to false (removes loading spinner)\n.finally(function(){_this.setState({is_loading:false});});};_this.clockIn=function(){var moment=require('moment');var todaysDate=moment().format('YYYY-MM-DD');console.log(todaysDate);var employee_id=_this.state.profile_id;var timeEntryData={\"date\":todaysDate,\"late\":false,\"employee\":employee_id// \"proficiency_rating\": rating,\n};console.log(timeEntryData);axios.post(\"\".concat(BASE_API_URL,\"api/time_entries/\"),timeEntryData,{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}}).then(function(response){console.log(response);_this.setState({latest_time_entry_id:response.data.time_entry_id});}).finally(function(response){var employeeProfileUpdateData={\"clocked_in\":true,\"current_shift\":_this.state.latest_time_entry_id// \"proficiency_rating\": rating,\n};axios.patch(\"\".concat(BASE_API_URL,\"api/employees/\").concat(_this.state.profile_id,\"/\"),employeeProfileUpdateData,{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}}).then(function(response){console.log(response);_this.getProfileInfo();}).catch(function(error){console.log(error);console.log(error.response);});});};_this.clockOut=function(){var moment=require('moment');var todaysDateAndTime=moment();console.log(todaysDateAndTime);var clockOutData={\"clock_out\":todaysDateAndTime};axios.patch(\"\".concat(BASE_API_URL,\"api/time_entries/\").concat(_this.state.profile.current_shift,\"/\"),clockOutData,{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}}).then(function(response){console.log(response);}).finally(function(response){var employeeProfileUpdateData={\"clocked_in\":false,\"current_shift\":_this.state.latest_time_entry_id// \"proficiency_rating\": rating,\n};axios.patch(\"\".concat(BASE_API_URL,\"api/employees/\").concat(_this.state.profile_id,\"/\"),employeeProfileUpdateData,{headers:{\"Authorization\":\"Bearer \".concat(localStorage.getItem('token'))}}).then(function(response){console.log(response);_this.getProfileInfo();}).catch(function(error){console.log(error);console.log(error.response);});});};_this.state={api:'http://localhost:8000/',logged_in:localStorage.getItem('token')?true:false,profile:{time_entries:['']}};var _moment=require('moment');return _this;}_createClass(EmployeeHomePage,[{key:\"componentDidMount\",value:function componentDidMount(){if(this.state.logged_in===true){this.getUserInfo();}else{this.setState({is_loading:false});}}},{key:\"render\",value:function render(){var _this2=this;return React.createElement(\"div\",null,React.createElement(NavBar,{logged_in:this.state.logged_in}),this.state.logged_in===true?React.createElement(Card,{className:\"logInFormCard\",bg:\"dark\",text:\"white\",style:{width:'50%'}},React.createElement(Card.Header,null,React.createElement(\"h3\",null,\" Welcome to Timely, \",this.state.first_name,\"! \")),React.createElement(Card.Body,null,React.createElement(Card.Text,null,\"Please select what you would like to do:\"),React.createElement(\"div\",{className:\"timeEntryButtons\"},React.createElement(\"div\",{className:\"timeEntryButtonsContainer\"},this.state.profile.clocked_in==true?React.createElement(Button,{variant:\"primary\",size:\"lg\",disabled:true},\"Clocked In\"):React.createElement(Button,{onClick:this.clockIn,className:\"timeEntryButton\",variant:\"primary\",size:\"lg\"},\"Clock In\"),React.createElement(Button,{onClick:this.clockOut,className:\"timeEntryButton\",variant:\"secondary\",size:\"lg\"},\"Clock Out\"))),React.createElement(\"div\",{className:\"previousShifts\"},React.createElement(\"h1\",null,\" Previous Shifts: \"),React.createElement(Accordion,{className:\"timeEntryAccordion\"},this.state.profile.time_entries.map(function(timeEntryInfo){var date=timeEntryInfo.date,clock_in=timeEntryInfo.clock_in,clock_out=timeEntryInfo.clock_out,late=timeEntryInfo.late,time_entry_id=timeEntryInfo.time_entry_id;return React.createElement(Card,null,React.createElement(Accordion.Toggle,{date:date,clock_in:clock_in,clock_out:clock_out,late:late,time_entry_id:time_entry_id,as:Card.Header,eventKey:time_entry_id},React.createElement(Moment,{format:\"MM/DD/YYYY\"},date)),React.createElement(Accordion.Collapse,{eventKey:time_entry_id},React.createElement(Card.Body,null,React.createElement(\"div\",{className:\"timeEntryDetailContainer\"},React.createElement(\"div\",{className:\"clockIn timeEntryDetail\"},React.createElement(\"h6\",null,React.createElement(\"b\",null,\" Clock In:\")),React.createElement(Moment,{format:\"hh:mm A\"},clock_in)),React.createElement(\"div\",{className:\"clockOut timeEntryDetail\"},React.createElement(\"h6\",null,React.createElement(\"b\",null,\" Clock Out:\")),clock_out==null?React.createElement(\"p\",null,\" Pending \"):React.createElement(Moment,{format:\"hh:mm A\"},clock_out)),React.createElement(\"div\",{className:\"late timeEntryDetail\"},\"\".concat(_this2.props.late)==true?React.createElement(\"div\",{className:'alertContainer'},React.createElement(Alert,{className:\"lateAlert\",variant:'danger'},\"Late\")):React.createElement(\"div\",{className:'alertContainer'},React.createElement(Alert,{className:\"lateAlert\",variant:'info'},\"On Time\")))))));}))))):React.createElement(Card,{className:\"logInFormCard\",bg:\"dark\",text:\"white\",style:{width:'50%'}},React.createElement(Card.Header,null,\"Log-In Required\"),React.createElement(Card.Body,null,React.createElement(Card.Text,null,\"You need to be logged-in to access this page.\"),React.createElement(LinkContainer,{to:\"/\"},React.createElement(Button,{variant:\"primary\",type:\"submit\"},\"Log In\")))));}}]);return EmployeeHomePage;}(Component);export default EmployeeHomePage;","map":{"version":3,"sources":["/Users/danielmiranda/PycharmProjects/timely/src/components/EmployeeHomePage.jsx"],"names":["React","Component","NavBar","Accordion","Card","Button","LinkContainer","Moment","Alert","axios","Collapse","BASE_API_URL","process","env","REACT_APP_BASE_URL","EmployeeHomePage","props","getUserInfo","get","headers","localStorage","getItem","then","response","currentUserInfo","data","setState","first_name","profile_id","id","is_loading","finally","getProfileInfo","state","params","profile","catch","error","console","log","clockIn","moment","require","todaysDate","format","employee_id","timeEntryData","post","latest_time_entry_id","time_entry_id","employeeProfileUpdateData","patch","clockOut","todaysDateAndTime","clockOutData","current_shift","api","logged_in","time_entries","width","clocked_in","map","timeEntryInfo","date","clock_in","clock_out","late","Header"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport '../css/EmployeeHomePage.css';\nimport NavBar from \"./NavBar\";\nimport Accordion from 'react-bootstrap/Accordion'\nimport Card from 'react-bootstrap/Card';\nimport Button from 'react-bootstrap/Button';\nimport {LinkContainer} from 'react-router-bootstrap';\nimport Moment from 'react-moment';\nimport Alert from 'react-bootstrap/Alert'\nimport axios from \"axios\";\nimport Collapse from 'react-bootstrap/Collapse'\n\nconst BASE_API_URL = process.env.REACT_APP_BASE_URL;\n\n\nclass EmployeeHomePage extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            api: 'http://localhost:8000/',\n            logged_in: localStorage.getItem('token') ? true : false,\n            profile: {\n                time_entries: ['']\n            }\n        }\n\n        var moment = require('moment');\n    }\n\n    componentDidMount() {\n        if (this.state.logged_in === true) {\n            this.getUserInfo();\n\n\n        } else {\n            this.setState({is_loading: false});\n        }\n\n    }\n\n    getUserInfo = () => {\n\n        axios.get(`${BASE_API_URL}timely_backend/current_user/`, {headers: {\"Authorization\": `Bearer ${localStorage.getItem('token')}`}})\n            .then((response) => {\n                let currentUserInfo = response.data;\n                this.setState({\n                    first_name: currentUserInfo.first_name,\n                    profile_id: currentUserInfo.id,\n                    is_loading: false,\n                });\n\n            })\n            .finally(() => {\n                this.getProfileInfo();\n            });\n    };\n\n    getProfileInfo = () => {\n        axios.get(`${BASE_API_URL}api/employees/${this.state.profile_id}/`, {\n            params: {}\n        })\n        //setting profile information in state\n            .then(response => {\n                let profile = response.data;\n                this.setState({profile: profile}); //preferredName = profile['preferred_name']\n            })\n            //if theres an error console log it\n            .catch(error => {\n                console.log(error);\n            })\n            //After everything, set is-loading to false (removes loading spinner)\n            .finally(() => {\n                this.setState({is_loading: false});\n\n            });\n\n\n    }\n\n\n    clockIn = () => {\n        var moment = require('moment');\n        let todaysDate = moment().format('YYYY-MM-DD')\n        console.log(todaysDate);\n        let employee_id = this.state.profile_id;\n\n\n        let timeEntryData = {\n            \"date\": todaysDate,\n            \"late\": false,\n            \"employee\": employee_id,\n            // \"proficiency_rating\": rating,\n        }\n\n        console.log(timeEntryData)\n        axios.post(`${BASE_API_URL}api/time_entries/`, timeEntryData, {headers: {\"Authorization\": `Bearer ${localStorage.getItem('token')}`}})\n            .then((response) => {\n                console.log(response);\n                this.setState({\n                    latest_time_entry_id: response.data.time_entry_id\n\n                })\n\n            })\n\n\n            .finally((response) => {\n                let employeeProfileUpdateData = {\n                    \"clocked_in\": true,\n                    \"current_shift\": this.state.latest_time_entry_id\n                    // \"proficiency_rating\": rating,\n                }\n                axios.patch(`${BASE_API_URL}api/employees/${this.state.profile_id}/`, employeeProfileUpdateData, {headers: {\"Authorization\": `Bearer ${localStorage.getItem('token')}`}})\n                    .then((response) => {\n                        console.log(response);\n                        this.getProfileInfo();\n\n                    })\n\n                    .catch((error) => {\n                        console.log(error);\n                        console.log(error.response);\n                    });\n\n\n            })\n    }\n\n\n    clockOut = () => {\n        var moment = require('moment');\n        let todaysDateAndTime = moment();\n        console.log(todaysDateAndTime);\n\n        let clockOutData = {\n            \"clock_out\": todaysDateAndTime,\n        }\n        axios.patch(`${BASE_API_URL}api/time_entries/${this.state.profile.current_shift}/`, clockOutData, {headers: {\"Authorization\": `Bearer ${localStorage.getItem('token')}`}})\n            .then((response) => {\n                console.log(response);\n\n            })\n            .finally((response) => {\n                let employeeProfileUpdateData = {\n                    \"clocked_in\": false,\n                    \"current_shift\": this.state.latest_time_entry_id\n                    // \"proficiency_rating\": rating,\n                }\n                axios.patch(`${BASE_API_URL}api/employees/${this.state.profile_id}/`, employeeProfileUpdateData, {headers: {\"Authorization\": `Bearer ${localStorage.getItem('token')}`}})\n                    .then((response) => {\n                        console.log(response);\n                        this.getProfileInfo();\n\n                    })\n\n                    .catch((error) => {\n                        console.log(error);\n                        console.log(error.response);\n                    });\n\n\n            })\n    }\n\n\n    render() {\n\n        return (\n            <div>\n                <NavBar logged_in={this.state.logged_in}/>\n                {this.state.logged_in === true ? (\n                        <Card className=\"logInFormCard\" bg=\"dark\" text=\"white\" style={{width: '50%'}}>\n                            <Card.Header><h3> Welcome to Timely, {this.state.first_name}! </h3></Card.Header>\n                            <Card.Body>\n                                <Card.Text>\n                                    Please select what you would like to do:\n                                </Card.Text>\n                                <div className={\"timeEntryButtons\"}>\n                                    <div className={\"timeEntryButtonsContainer\"}>\n                                        {this.state.profile.clocked_in == true ? (\n                                            <Button variant=\"primary\" size=\"lg\" disabled>\n                                                Clocked In\n                                            </Button>) : (\n                                            <Button onClick={this.clockIn} className={\"timeEntryButton\"} variant=\"primary\"\n                                                    size=\"lg\">\n                                                Clock In\n                                            </Button>)}\n\n                                        <Button onClick={this.clockOut} className={\"timeEntryButton\"} variant=\"secondary\"\n                                                size=\"lg\">\n                                            Clock Out\n                                        </Button>\n                                    </div>\n                                </div>\n                                <div className={\"previousShifts\"}>\n                                    <h1> Previous Shifts: </h1>\n                                    <Accordion className={\"timeEntryAccordion\"}>\n\n                                        {this.state.profile.time_entries.map(timeEntryInfo => {\n                                            const {date, clock_in, clock_out, late, time_entry_id} = timeEntryInfo;\n\n                                            return (\n\n                                                <Card>\n                                                    <Accordion.Toggle date={date} clock_in={clock_in}\n                                                                      clock_out={clock_out} late={late}\n                                                                      time_entry_id={time_entry_id} as={Card.Header}\n                                                                      eventKey={time_entry_id}>\n                                                        <Moment\n                                                            format=\"MM/DD/YYYY\">{date}</Moment>\n                                                    </Accordion.Toggle>\n                                                    <Accordion.Collapse eventKey={time_entry_id}>\n                                                        <Card.Body>\n                                                            <div className={\"timeEntryDetailContainer\"}>\n                                                                <div className={\"clockIn timeEntryDetail\"}>\n                                                                    <h6><b> Clock In:</b></h6>\n                                                                    <Moment\n                                                                        format=\"hh:mm A\">{clock_in}</Moment>\n                                                                </div>\n                                                                <div className={\"clockOut timeEntryDetail\"}>\n                                                                    <h6><b> Clock Out:</b></h6>\n                                                                    { clock_out == null? (<p> Pending </p> ) : ( <Moment\n                                                                        format=\"hh:mm A\">{clock_out}</Moment>) }\n\n\n                                                                </div>\n                                                                <div className={\"late timeEntryDetail\"}>\n\n                                                                    {`${this.props.late}` == true ? (\n                                                                        <div className={'alertContainer'}>\n                                                                            <Alert className={\"lateAlert\"}\n                                                                                   variant={'danger'}>\n                                                                                Late\n                                                                            </Alert>\n                                                                        </div>) : (\n                                                                        <div className={'alertContainer'}><Alert\n                                                                            className={\"lateAlert\"} variant={'info'}>\n                                                                            On Time\n                                                                        </Alert>\n                                                                        </div>)}\n                                                                </div>\n\n                                                            </div>\n                                                        </Card.Body>\n                                                    </Accordion.Collapse>\n                                                </Card>\n\n                                            )\n                                        })}\n                                    </Accordion>\n                                </div>\n                            </Card.Body>\n                        </Card>\n                    )\n\n                    : (<Card className=\"logInFormCard\" bg=\"dark\" text=\"white\" style={{width: '50%'}}>\n                        <Card.Header>Log-In Required</Card.Header>\n                        <Card.Body>\n                            <Card.Text>\n                                You need to be logged-in to access this page.\n                            </Card.Text>\n                            <LinkContainer to=\"/\">\n                                <Button variant=\"primary\" type=\"submit\">\n                                    Log In\n                                </Button>\n                            </LinkContainer>\n\n                        </Card.Body>\n                    </Card>)\n\n                }\n            </div>\n        );\n    }\n}\n\n\nexport default EmployeeHomePage;"]},"metadata":{},"sourceType":"module"}